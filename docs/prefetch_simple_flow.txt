预读功能简易流程图
==================

1. 主要预读流程
┌─────────────┐
│  页面访问请求  │
└─────┬───────┘
      │
      ▼
┌─────────────┐
│ 检查缓存命中  │
└─────┬───────┘
      │
      ▼
    ┌─是─→ 返回页面
    │
    └─否─→ 继续
      │
      ▼
┌─────────────┐
│ 预读策略判断  │
└─────┬───────┘
      │
      ▼
┌─────────────────────────────────┐
│       策略类型选择               │
├─NONE─→ 直接加载                 │
├─SEQUENTIAL─→ 检查顺序性         │
├─RANDOM─→ 执行预读              │
└─ADAPTIVE─→ 智能决策            │
└─────────────────────────────────┘
      │
      ▼
┌─────────────┐
│ 执行预读操作  │
└─────┬───────┘
      │
      ▼
┌─────────────┐
│ 更新统计信息  │
└─────┬───────┘
      │
      ▼
┌─────────────┐
│  返回页面    │
└─────────────┘

2. 自适应决策流程
┌─────────────┐
│ 获取访问历史  │
└─────┬───────┘
      │
      ▼
┌─────────────┐
│ 计算模式评分  │
└─────┬───────┘
      │
      ▼
┌─────────────┐
│ 评分 > 阈值? │
└─────┬───────┘
      │
    ┌─是─→ 执行预读
    │
    └─否─→ 跳过预读

3. 预读执行流程
┌─────────────┐
│ 生成页面ID列表│
└─────┬───────┘
      │
      ▼
┌─────────────┐
│ 检查缓存状态  │
└─────┬───────┘
      │
      ▼
┌─────────────┐
│ 应用数量限制  │
└─────┬───────┘
      │
      ▼
┌─────────────┐
│ 异步I/O执行  │
└─────┬───────┘
      │
      ▼
┌─────────────┐
│ 更新缓存    │
└─────────────┘

4. 性能监控流程
┌─────────────┐
│ 收集统计数据  │
└─────┬───────┘
      │
      ▼
┌─────────────┐
│ 计算性能指标  │
└─────┬───────┘
      │
      ▼
┌─────────────────────────────────┐
│        效率分析                 │
├─效率 > 80%─→ 增加预读数量       │
├─效率 < 30%─→ 减少预读数量       │
└─30% ≤ 效率 ≤ 80%─→ 保持数量    │
└─────────────────────────────────┘
      │
      ▼
┌─────────────┐
│ 调整预读参数  │
└─────────────┘

5. 阈值控制流程
┌─────────────┐
│ 检查触发阈值  │
└─────┬───────┘
      │
      ▼
┌─────────────┐
│ 检查顺序阈值  │
└─────┬───────┘
      │
      ▼
┌─────────────┐
│ 检查激进阈值  │
└─────┬───────┘
      │
      ▼
┌─────────────┐
│ 检查效率阈值  │
└─────┬───────┘
      │
      ▼
┌─────────────┐
│ 检查数量阈值  │
└─────────────┘

6. 完整系统流程
┌─────────────┐
│   系统启动   │
└─────┬───────┘
      │
      ▼
┌─────────────┐
│ 初始化配置   │
└─────┬───────┘
      │
      ▼
┌─────────────┐
│ 启动I/O线程池│
└─────┬───────┘
      │
      ▼
┌─────────────────────────────────┐
│          主循环                 │
│  ┌─────────────┐               │
│  │ 接收访问请求  │               │
│  └─────┬───────┘               │
│        │                       │
│        ▼                       │
│  ┌─────────────┐               │
│  │ 执行预读决策  │               │
│  └─────┬───────┘               │
│        │                       │
│        ▼                       │
│  ┌─────────────┐               │
│  │ 执行预读操作  │               │
│  └─────┬───────┘               │
│        │                       │
│        ▼                       │
│  ┌─────────────┐               │
│  │ 更新性能统计  │               │
│  └─────┬───────┘               │
│        │                       │
│        ▼                       │
│  ┌─────────────┐               │
│  │ 返回请求结果  │               │
│  └─────────────┘               │
└─────────────────────────────────┘
      │
      ▼
┌─────────────┐
│   系统关闭   │
└─────────────┘

关键决策点说明：
===============

1. 缓存命中检查
   - 页面在缓存中 → 直接返回
   - 页面不在缓存 → 触发预读流程

2. 策略类型判断
   - NONE: 不预读，直接加载
   - SEQUENTIAL: 只在顺序访问时预读
   - RANDOM: 总是预读
   - ADAPTIVE: 智能决策预读

3. 访问模式分析
   - 计算访问模式评分 (0.0-1.0)
   - 与激进程度阈值比较
   - 决定是否执行预读

4. 预读数量控制
   - 基于效率动态调整
   - 基于访问模式调整
   - 应用最大数量限制

5. 性能反馈机制
   - 实时统计预读效果
   - 动态调整预读参数
   - 持续优化预读策略

阈值说明：
=========

- 触发阈值 (3): 连续访问3次后开始预读
- 顺序阈值 (0.7): 70%以上顺序访问才认为是顺序模式
- 激进阈值 (0.5): 访问模式评分超过0.5才预读
- 效率阈值 (0.8/0.3): 效率超过80%增加预读，低于30%减少预读
- 数量阈值 (10): 单次最多预读10页
